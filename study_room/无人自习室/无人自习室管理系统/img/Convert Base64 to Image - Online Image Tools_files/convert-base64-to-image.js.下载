window.bridges["convert-base64-to-image"]=function(){var e={data:null,preview:null},p=null,u=null,v=null,f=function(i){var t=this;p||(p=t.input.element.querySelector(".data"),e.data=t.output.element.querySelector(".data"),e.preview=t.output.element.querySelector(".preview"));var o=t.input.element.querySelector(".side-box").classList.contains("empty");if(!o){e.preview.width!=e.preview.clientWidth&&(e.preview.width=e.preview.clientWidth,e.preview.height=e.preview.clientHeight),i=i.replace(/\n/g,""),i.match(/^data:image\/([\w\-]+);base64,/)||(i="data:image/png;base64,"+i);try{u=w(i)}catch(r){t.output.showNegativeBadge("Can't convert","Unable to decode Base64.",-1);return}v=t.options.get().extension||"png",t.options.describe("file","Will be saved as: output-{0}.{1}".format(t.siteName,v));var a=new Image;a.onload=function(){e.data.width=a.width,e.data.height=a.height;var r=e.data.getContext("2d");r.drawImage(a,0,0),t.respond(),r=e.preview.getContext("2d"),r.clearRect(0,0,e.preview.width,e.preview.height),g(e.preview);var n=best_image_fit(e.data.width,e.data.height,e.preview.width,e.preview.height);r.drawImage(e.data,n.offsetX,n.offsetY,n.width,n.height)},a.src=i}};function h(i){var t=this;return u?i([u,"output-"+t.siteName+"."+v],null):i(null,"nothing to save")}function w(i){for(var t=i.slice(5).split(";"),o=window.atob(t[1].split(",")[1]),a=[],r=0;r<o.length;r++)a.push(o.charCodeAt(r));return new Blob([new Uint8Array(a)],{type:t[0]})}function g(i){for(var t=i.getContext("2d"),o=i.width,a=i.height,r=15,n=!0,l=0;l<=o;l+=r)for(var d=0;d<=a;d+=r)n?t.fillStyle="#ffffff":t.fillStyle="#efefef",n=!n,t.fillRect(l,d,l+r,d+r)}return{converter:f,config:{type:"image",output:{noClipboard:!0},override:{"output.download":h}}}};
